(function(e,t){function n(e,t){n.modules[e]=t}function r(e){var t=e.split("/"),n=[];for(var r=0;r<t.length;r++)t[r]!="."&&(t[r]==".."?n.pop():n.push(t[r]));return n.join("/")}function i(e,t){return e?e.trim().replace(/\/*$/,"/")+t.trim():t.trim()}function s(e){return e?e.split("/").slice(0,-1).join("/"):null}function o(e,u){u=r(i(s(e),u));if(u in n.exports)return n.exports[u];if(u in n.modules){var a=n.modules[u];if(typeof a=="function"){var f={},l=a(o.bind(null,u),f,{id:u,uri:""});a=l!==t?l:f}return n.exports[u]=a}throw new Error("Module not defined: "+u)}n.modules={},n.exports={};var u=o.bind(null,null);n("l20n/html",function(e,t,n){"use strict";function l(){var e=document.head,t=e.querySelector('script[type="application/l10n-data+json"]');t&&u.updateData(JSON.parse(t.textContent));var n=e.querySelectorAll('script[type="application/l20n"]');if(n.length){for(var r=0;r<n.length;r++)n[r].hasAttribute("src")?u.linkResource(n[r].getAttribute("src")):u.addResource(n[r].textContent);u.requestLocales()}else{var i=e.querySelector('link[rel="localization"]');i?m(i.getAttribute("href")):console.warn("L20n: No resources found. (Put them above l20n.js.)")}document.readyState!=="loading"?c():document.addEventListener("readystatechange",c),h()}function c(){var e=y(document);o=u.localize(e.ids,function(n){e||(e=y(document));for(var r=0;r<e.nodes.length;r++)b(e.nodes[r],e.ids[r],n.entities[e.ids[r]]);"locales"in n.reason&&n.reason.locales.length&&p(n.reason.locales[0]),e=null,f||(f=!0,g())}),document.removeEventListener("readystatechange",c)}function h(){u.addEventListener("error",console.warn.bind(console)),u.addEventListener("debug",console.error.bind(console)),u.localizeNode=function(t){var n=y(t),r=o.extend(n.ids);for(var i=0;i<n.nodes.length;i++)b(n.nodes[i],n.ids[i],r.entities[n.ids[i]])},u.once=function(t){if(f)t();else{var n=function r(){document.removeEventListener("DocumentLocalized",r),t()};document.addEventListener("DocumentLocalized",n)}},document.l10n=u}function p(e){document.documentElement.lang=e,document.documentElement.dir=a.indexOf(e)===-1?"ltr":"rtl"}function d(t){u.registerLocales(t.default_locale,t.locales),u.registerLocaleNegotiator(function(t,n,r){var i=e("./intl").Intl,s=e("./promise").Promise,o=i.prioritizeLocales(t,n,r),u=new s;return p(o[0]),setTimeout(function(){u.fulfill(o)}),u});var n=/{{\s*locale\s*}}/;return t.resources.forEach(function(e){n.test(e)?u.linkResource(e.replace.bind(e,n)):u.linkResource(e)}),u.requestLocales(navigator.language||navigator.browserLanguage),t}function v(e,t){if(t[0]=="/")return t;var n=e.split("/").slice(0,-1).concat(t.split("/")).filter(function(e){return e!=="."});return n[0]!==""&&n[0]!==".."&&n.unshift("."),n.join("/")}function m(e){var t=new i;return s.loadAsync(e).then(function(n){var r=JSON.parse(n);r.resources=r.resources.map(v.bind(this,e)),d(r),t.fulfill()}),t}function g(){var e=document.createEvent("Event");e.initEvent("DocumentLocalized",!1,!1),document.dispatchEvent(e)}function y(e){var t=e.querySelectorAll("[data-l10n-id]"),n=[];e.hasAttribute&&e.hasAttribute("data-l10n-id")&&(t=Array.prototype.slice.call(t),t.push(e));for(var r=0;r<t.length;r++)n.push(t[r].getAttribute("data-l10n-id"));return{ids:n,nodes:t}}function b(e,t,n){if(!n)return;for(var r in n.attributes)e.setAttribute(r,n.attributes[r]);n.value&&(e.hasAttribute("data-l10n-overlay")?w(e,n.value):e.textContent=n.value)}function w(e,t){var n=e._l20nSourceNode||e,r=n.cloneNode(!1);r.innerHTML=t;var i=r.getElementsByTagName("*");for(var s=0,o;o=i[s];s++){var u=E(o,r),a=S(u,n);if(!a)continue;for(var f=0,l;l=a.attributes[f];f++)o.hasAttribute(l.name)||o.setAttribute(l.nodeName,l.value)}r._l20nSourceNode=n,e.parentNode.replaceChild(r,e);return}function E(e,t){var n=1;if(e===t)return".";var r=e.getAttribute("id");if(r)return'*[@id="'+r+'"]';var i=e.getAttribute("data-l10n-path");if(i)return e.removeAttribute("data-l10n-path"),i;var s=0,o=e.parentNode.childNodes;for(var u=0,a;a=o[u];u++){if(a===e){var f=E(e.parentNode,t);return f+"/"+e.tagName+"["+(s+1)+"]"}a.nodeType===n&&a.tagName===e.tagName&&s++}throw"Can't find the path to element "+e}function S(e,t){var n=document.evaluate(e,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return n.singleNodeValue}var r=e("../l20n"),i=e("./promise").Promise,s=e("./platform/io"),o,u=r.getContext(document.location.host),a=["ar","fa","he","ps","ur"],f=!1;return l(),r}),n("l20n",function(e,t,n){"use strict";var r=e("./l20n/context").Context,i=e("./l20n/parser").Parser,s=e("./l20n/compiler").Compiler;t.Context=r,t.Parser=i,t.Compiler=s,t.getContext=function(t){return new r(t)}}),n("l20n/context",function(e,n,r){"use strict";function l(e,t){function i(e,t){if(e>=7)throw new p("Too many nested imports.");if(!t){s(t),o(),a(e+1,t),c();return}return s(t).then(o).then(a.bind(this,e+1,t)).then(c)}function s(e){if(!e){if(n.source)return n.source;try{return n.source=f.loadSync(n.id)}catch(t){if(t instanceof f.Error)return n.source="";throw t}}if(n.source){var r=new u;return r.fulfill(),r}return f.loadAsync(n.id).then(function(t){n.source=t})}function o(){n.ast=t.parse(n.source)}function a(e,i){var s=n.ast.body.filter(function(e,t){return e.type=="ImportStatement"?(r.push(t),!0):!1});s.forEach(function(e){var r=h(e.uri.content),i=new l(r,t);n.resources.push(i)});var o=[];n.resources.forEach(function(t){o.push(t.build(e,i))});if(i)return u.all(o)}function c(){for(var e=n.resources.length-1;e>=0;e--){var t=r[e]||0;Array.prototype.splice.apply(n.ast.body,[t,1].concat(n.resources[e].ast.body))}n.isReady=!0}function h(e){if(n.id===null||e[0]=="/")return e;var t=n.id.split("/").slice(0,-1).join("/");return t?(t[t.length-1]=="/"&&(t=t.slice(0,t.length-1)),t+"/"+e):"./"+e}var n=this;this.id=e,this.resources=[],this.source=null,this.isReady=!1,this.ast={type:"LOL",body:[]},this.build=i;var r=[]}function c(e,n,r){function s(e){return e?o(e).then(a).then(f):(o(e),a(),f(),this)}function o(e){var t=[];i.resources.forEach(function(n){t.push(n.build(0,e))});if(e)return u.all(t)}function a(){i.ast.body=i.resources.reduce(function(e,t){return e.concat(t.ast.body)},i.ast.body)}function f(){i.entries=r.compile(i.ast),i.isReady=!0}function l(e){return this.entries.hasOwnProperty(e)?this.entries[e]:t}function c(e){return this.resources.some(function(t){return t.id===e})}this.id=e,this.resources=[],this.entries=null,this.ast={type:"LOL",body:[]},this.isReady=!1,this.build=s,this.getEntry=l,this.hasResource=c;var i=this}function h(n){function A(e,n){for(var r in n)n[r]===t?delete e[r]:typeof n[r]!="object"?e[r]=n[r]:(typeof e[r]!="object"&&(e[r]={}),A(e[r],n[r]))}function O(e){if(!e||typeof e!="object")throw new p("Context data must be a non-null object");A(r,e)}function M(e,t){if(!E)throw new p("Context not ready");return j.call(L,0,e,t).value}function _(e,t){if(!E)throw new p("Context not ready");return j.call(L,0,e,t)}function D(e,t){if(!t)throw new p("No callback passed");return H.call(L,e,t)}function P(e){E&&setTimeout(e),J("ready",e)}function H(e,t,n){var r={extend:function(r){for(var i=0;i<r.length;i++)e.indexOf(r[i])===-1&&e.push(r[i]);if(!E)return;var s=B.call(this,r);return C.bindGet({id:t,callback:H.bind(this,e,t),globals:Object.keys(s.globalsUsed)},!0),s}.bind(this),stop:function(){C.unbindGet(t)}.bind(this)};if(!E)return C.bindGet({id:t,callback:H.bind(this,e,t),globals:[]}),r;var i=B.call(this,e),s={entities:i.entities,reason:n||{locales:y.slice()},stop:function(){C.unbindGet(t)}};return C.bindGet({id:t,callback:H.bind(this,e,t),globals:Object.keys(i.globalsUsed)}),t(s),r}function B(e){var t={entities:{},globalsUsed:{}};for(var n=0,r;r=e[n];n++){t.entities[r]=_.call(this,r);for(var i in t.entities[r].globals)t.globalsUsed[i]=!0}return t}function j(e,n,r,i){var s=y[e];if(!s){var u=new v("Entity couldn't be retrieved",n,y.slice());return x.emit("error",u),{value:i?i:n,attributes:{},globals:{},locale:null}}var a=X(s);a.isReady||a.build(!1);var f=a.getEntry(n);if(f===t)return x.emit("error",new d("Not found",n,a.id)),j.call(this,e+1,n,r,i);try{var l=f.get(F.call(this,r))}catch(c){if(c instanceof o.RuntimeError)return x.emit("error",new d(c.message,n,a.id)),j.call(this,e+1,n,r,i||c.source);throw c}return l.locale=a.id,l}function F(e){if(!e)return r;var t={};return A(t,r),A(t,e),t}function I(e){if(S)throw new p("Context is frozen");w.push(["text",e])}function q(e,t){var n=new l(null,T);n.source=e,t.resources.push(n)}function R(e){if(S)throw new p("Context is frozen");w.push([typeof e=="function"?"template":"uri",e])}function U(e,t){if(!t.hasResource(e)){var n=new l(e,T);t.resources.push(n)}}function z(e,n){if(S)throw new p("Context is frozen");if(e===t)return;h=e,m=[],n||(n=[]),n.push(e);for(var r in n){var i=n[r];if(typeof i!="string")throw new p("Language codes must be strings");m.indexOf(i)===-1&&m.push(i)}}function W(e){if(S)throw new p("Context is frozen");f=e}function X(e){if(b[e])return b[e];var t=b[e]=new c(e,T,N);for(var n=0;n<w.length;n++){var r=w[n];r[0]==="text"?q(r[1],t):r[0]==="uri"?U(r[1],t):U(r[1](t.id),t)}return t}function V(){if(S&&!E)throw new p("Context not ready");S=!0,g=Array.prototype.slice.call(arguments);if(w.length==0)throw new p("Context has no resources");var t=new u;t.then(function(t){if(!f){var n=e("./intl").Intl;f=n.prioritizeLocales}return f(t,g,h)}).then(function(e){return y=e,X(y[0])}).then(function(e){return e.isReady?$():e.build(!0)},Q.bind(null,"error")).then($).then(null,Q.bind(null,"debug")),t.fulfill(m)}function $(){E=!0,C.all(y.slice()),x.emit("ready")}function J(e,t){x.addEventListener(e,t)}function K(e,t){x.removeEventListener(e,t)}function Q(e,t){x.emit(e,t)}this.id=n,this.registerLocales=z,this.registerLocaleNegotiator=W,this.requestLocales=V,this.addResource=I,this.linkResource=R,this.updateData=O,this.get=M,this.getEntity=_,this.localize=D,this.ready=P,this.addEventListener=J,this.removeEventListener=K,Object.defineProperty(this,"supportedLocales",{get:function(){return y.slice()},enumerable:!0});var r={},f,h="i-default",m=[h],g=[],y=[],b={},w=[],E=!1,S=!1,x=new i,T=new s,N=new o,C=new a,k=[],L=this;T.addEventListener("error",Q.bind(null,"error")),N.addEventListener("error",Q.bind(null,"error")),N.setGlobals(C.globals)}function p(e){this.name="ContextError",this.message=e}function d(e,t,n){p.call(this,e),this.name="EntityError",this.id=t,this.locale=n,this.message="["+n+"] "+t+": "+e}function v(e,t,n){p.call(this,e),this.name="GetError",this.id=t,this.tried=n,this.message=t+": "+e+"; tried "+n.join(", ")}var i=e("./events").EventEmitter,s=e("./parser").Parser,o=e("./compiler").Compiler,u=e("./promise").Promise,a=e("./retranslation").RetranslationManager;e("./platform/globals");var f=e("./platform/io");h.Error=p,h.EntityError=d,p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,d.prototype=Object.create(p.prototype),d.prototype.constructor=d,v.prototype=Object.create(p.prototype),v.prototype.constructor=v,n.Context=h}),n("l20n/events",function(e,t,n){"use strict";function r(){this._listeners={}}r.prototype.emit=function(){var t=Array.prototype.slice.call(arguments),n=t.shift();if(!this._listeners[n])return!1;var r=this._listeners[n].slice();for(var i=0;i<r.length;i++)r[i].apply(this,t);return!0},r.prototype.addEventListener=function(t,n){return this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(n),this},r.prototype.removeEventListener=function(t,n){var r=this._listeners[t],i=r.indexOf(n);return i===-1?this:(r.splice(i,1),this)},t.EventEmitter=r}),n("l20n/parser",function(e,n,r){"use strict";function s(e){function l(){s+=2;var e=s,t=r.indexOf("*/",e);if(t===-1)throw Y("Comment without closing tag");return s=t+2,{type:"Comment",content:r.slice(e,t)}}function c(){var e=[],t,n,i;for(;;){t=p("Attribute"),t.local=t.key.name.charAt(0)==="_",e.push(t),n=g(),i=r.charAt(s);if(i===">")break;if(!n)throw Y('Expected ">"')}return e}function h(e){var t=w();y();if(r.charAt(s)!==":")throw Y('Expected ":"');return++s,y(),{type:e,key:t,value:m()}}function p(e){var t=w(),n=[];r.charAt(s)==="["&&(++s,y(),n=G(_,"]")),y();if(r.charAt(s)!==":")throw Y('Expected ":"');return++s,y(),{type:e,key:t,value:m(),index:n}}function d(){++s,y();var e,t,n,i=[],o=!1;for(;;){e=!1;if(r.charAt(s)==="*"){++s;if(o)throw Y("Default item redefinition forbidden");e=!0,o=!0}t=h("HashItem"),t["default"]=e,i.push(t),y(),n=r.charAt(s)===",",n&&(++s,y());if(r.charAt(s)==="}"){++s;break}if(!n)throw Y('Expected "}"')}return{type:"Hash",content:i}}function v(e){var n=e.length,i=s+n,o=r.indexOf(e,i);while(o!==-1&&r.charCodeAt(o-1)===92&&r.charCodeAt(o-2)!==92)o=r.indexOf(e,o+1);if(o===-1)throw Y("Unclosed string literal");var u=r.slice(i,o);return s=o+n,{type:"String",content:u,isNotComplex:u.indexOf("{{")===-1||t}}function m(e,n){n===t&&(n=r.charAt(s));if(n==="'"||n==='"')return n===r.charAt(s+1)&&n===r.charAt(s+2)?v(n+n+n):v(n);if(n==="{")return d();if(!e)throw Y("Unknown value type");return null}function g(){var e=s,t=r.charCodeAt(e);while(t===32||t===10||t===9||t===13)t=r.charCodeAt(++s);return s!==e}function y(){var e=r.charCodeAt(s);while(e===32||e===10||e===9||e===13)e=r.charCodeAt(++s)}function b(){return++s,{type:"VariableExpression",id:w()}}function w(){var e=s,t=e,n=r,i=n.charCodeAt(t);if((i<97||i>122)&&(i<65||i>90)&&i!==95)throw Y("Identifier has to start with [a-zA-Z_]");i=n.charCodeAt(++e);while(i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||i===95)i=n.charCodeAt(++e);return s=e,{type:"Identifier",name:n.slice(t,e)}}function E(){s+=6;if(r.charAt(s)!=="(")throw Y('Expected "("');++s,y();var e=v(r.charAt(s));y();if(r.charAt(s)!==")")throw Y('Expected ")"');return++s,{type:"ImportStatement",uri:e}}function S(e){if(e.name.charAt(0)==="_")throw Y('Macro ID cannot start with "_"');++s;var t=G(b,")");g();if(r.charAt(s)!=="{")throw Y('Expected "{"');++s,y();var n=_();y();if(r.charAt(s)!=="}")throw Y('Expected "}"');++s,y();if(r.charCodeAt(s)!==62)throw Y('Expected ">"');return++s,{type:"Macro",id:e,args:t,expression:n}}function x(e,t){if(!g())throw Y("Expected white space");var n=r.charAt(s),i=m(!0,n),o=[];if(i===null){if(n===">")throw Y('Expected ">"');o=c()}else{var u=g();if(r.charAt(s)!==">"){if(!u)throw Y('Expected ">"');o=c()}}return++s,{type:"Entity",id:e,value:i,index:t,attrs:o,local:e.name.charCodeAt(0)===95}}function T(){var e=r.charCodeAt(s);if(e===60){++s;var t=w();return e=r.charCodeAt(s),e===40?S(t):e===91?(++s,x(t,G(_,"]"))):x(t,[])}if(r.charCodeAt(s)===47&&r.charCodeAt(s+1)===42)return l();if(r.slice(s,s+6)==="import")return E();throw Y("Invalid entry")}function N(){var e,t,i=s,o=!1,a=0,f=r.indexOf("\\");while(f!==-1){e=r.charAt(f+1);if(e=='"'||e=="'"||e=="\\")r=r.substr(0,f)+r.substr(f+1);f=r.indexOf("\\",f+1)}f=r.indexOf("{{");while(f!==-1){if(r.charCodeAt(f-1)===92){r=r.substr(0,f-1)+r.substr(f),f=r.indexOf("{{",f+2);continue}o||(t=[],o=!0);if(a>n-1)throw Y("Too many placeables, maximum allowed is "+n);i<f&&t.push({type:"String",content:r.slice(i,f)}),s=f+2,y(),t.push(_()),y();if(r.charCodeAt(s)!==125||r.charCodeAt(s+1)!==125)throw Y('Expected "}}"');a++,f=s+2,i=f,f=r.indexOf("{{",f)}return o?(i<u&&t.push({type:"String",content:r.slice(i)}),{type:"ComplexString",content:t}):{type:"String",content:r}}function C(){var e=[];y();while(s<u){try{e.push(T())}catch(t){if(!(t instanceof o))throw t;a.emit("error",t),e.push(Z())}s<u&&y()}return{type:"LOL",body:e}}function k(){var e=[];y();while(s<u)e.push(T()),s<u&&y();return{type:"LOL",body:e}}function L(e){r=e,s=0,u=r.length;try{return N()}catch(t){throw a&&t instanceof o&&a.emit("error",t),t}}function A(e){return r=e,s=0,u=r.length,f()}function O(e,t){if(!a)throw Error("Emitter not available");return a.addEventListener(e,t)}function M(e,t){if(!a)throw Error("Emitter not available");return a.removeEventListener(e,t)}function _(){return H()}function D(e,t,n,i){var o=i(),u,a;for(;;){u="",y(),a=r.charAt(s);if(e[0].indexOf(a)===-1)break;u+=a,++s;if(e.length>1){a=r.charAt(s);if(e[1]==a)++s,u+=a;else if(e[2])return--s,o}y(),o={type:t,operator:{type:n,token:u},left:o,right:i()}}return o}function P(e,t,n,i){var o=r.charCodeAt(s);return e.indexOf(o)===-1?i():(++s,y(),{type:t,operator:{type:n,token:String.fromCharCode(o)},argument:P(e,t,n,i)})}function H(){var e=B();y();if(r.charCodeAt(s)!==63)return e;++s,y();var t=_();y();if(r.charCodeAt(s)!==58)throw Y('Expected ":"');return++s,y(),{type:"ConditionalExpression",test:e,consequent:t,alternate:_()}}function B(){return D([["|"],"|",!0],"LogicalExpression","LogicalOperator",j)}function j(){return D([["&"],"&",!0],"LogicalExpression","Logicalperator",F)}function F(){return D([["=","!"],"=",!0],"BinaryExpression","BinaryOperator",I)}function I(){return D([["<",">"],"=",!1],"BinaryExpression","BinaryOperator",q)}function q(){return D([["+","-"]],"BinaryExpression","BinaryOperator",R)}function R(){return D([["%"]],"BinaryExpression","BinaryOperator",U)}function U(){return D([["*"]],"BinaryExpression","BinaryOperator",z)}function z(){return D([["/"]],"BinaryExpression","BinaryOperator",W)}function W(){return P([43,45,33],"UnaryExpression","UnaryOperator",J)}function X(e){return y(),{type:"CallExpression",callee:e,arguments:G(_,")")}}function V(e,t){if(e.type!=="ParenthesisExpression"&&e.type!=="Identifier"&&e.type!=="ThisExpression")throw Y("AttributeExpression must have Identifier, This or Parenthesis as left node");var n;if(t){y(),n=_(),y();if(r.charAt(s)!=="]")throw Y('Expected "]"');return++s,{type:"AttributeExpression",expression:e,attribute:n,computed:!0}}return n=w(),{type:"AttributeExpression",expression:e,attribute:n,computed:!1}}function $(e,t){var n;if(t){y(),n=_(),y();if(r.charAt(s)!=="]")throw Y('Expected "]"');return++s,{type:"PropertyExpression",expression:e,property:n,computed:!0}}return n=w(),{type:"PropertyExpression",expression:e,property:n,computed:!1}}function J(){var e=K(),t;for(;;){t=r.charCodeAt(s);if(t===46||t===91)++s,e=$(e,t===91);else if(t===58&&r.charCodeAt(s+1)===58)s+=2,r.charCodeAt(s)===91?(++s,e=V(e,!0)):e=V(e,!1);else{if(t!==40)break;++s,e=X(e)}}return e}function K(){if(r.charCodeAt(s)===40){++s,y();var e={type:"ParenthesisExpression",expression:_()};y();if(r.charCodeAt(s)!==41)throw Y('Expected ")"');return++s,e}return Q()}function Q(){var e=s,t=r.charCodeAt(e);while(t>47&&t<58)t=r.charCodeAt(++e);if(e>s){var n=s;return s=e,{type:"Number",value:parseInt(r.slice(n,e),10)}}switch(t){case 39:case 34:case 123:case 91:return m();case 36:return b();case 64:return++s,{type:"GlobalsExpression",id:w()};case 126:return++s,{type:"ThisExpression"};default:return w()}}function G(e,t){var n;y();if(r.charAt(s)===t)return++s,[];var i=[];for(;;){i.push(e()),y(),n=r.charAt(s);if(n!==","){if(n===t){++s;break}throw Y('Expected "," or "'+t+'"')}++s,y()}return i}function Y(e,n){n===t&&(n=s);var i=r.lastIndexOf("<",n-1),u=r.lastIndexOf(">",n-1);i=u>i?u+1:i;var a=r.slice(i,n+10),f=e+" at pos "+n+': "'+a+'"';return new o(f,n,a)}function Z(){var e=r.indexOf("<",s),t;return e===-1?(t={type:"JunkEntry",content:r.slice(s)},s=u,t):(t={type:"JunkEntry",content:r.slice(s,e)},s=e,t)}this.parse=A,this.parseString=L,this.addEventListener=O,this.removeEventListener=M;var n=100,r,s,u,a,f;e?f=k:(a=new i,f=C)}function o(e,t,n){this.name="ParserError",this.message=e,this.pos=t,this.context=n}var i=e("./events").EventEmitter;s.Error=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,n.Parser=s}),n("l20n/compiler",function(e,n,r){"use strict";function o(){function d(e,t){t||(t={});for(var n=0,r;r=e.body[n];n++){var i=p[r.type];if(i)try{t[r.id.name]=new i(r,t)}catch(s){h(s)}}return t}function v(e){return o=e,!0}function m(e,t){return n.addEventListener(e,t)}function g(e,t){return n.removeEventListener(e,t)}function y(e,t,r,i){var s=new e(t,r,i);return n.emit("error",s),s}function b(e,t){this.id=e.id.name,this.env=t,this.local=e.local||!1,this.index=[],this.attributes={},this.publicAttributes=[];var n;for(n=0;n<e.index.length;n++)this.index.push(_(e.index[n],this));for(n=0;n<e.attrs.length;n++){var r=e.attrs[n];this.attributes[r.key.name]=new w(r,this),r.local||this.publicAttributes.push(r.key.name)}e.value&&e.value.isNotComplex?this.value=e.value.content:this.value=x(e.value,this,this.index)}function w(e,t){this.key=e.key.name,this.local=e.local||!1,this.index=[];for(var n=0;n<e.index.length;n++)this.index.push(_(e.index[n],this));e.value&&e.value.isNotComplex?this.value=e.value.content:this.value=x(e.value,t,this.index),this.entity=t}function E(e,t){this.id=e.id.name,this.env=t,this.local=e.local||!1,this.expression=x(e.expression,this),this.args=e.args}function x(e,t,n){if(!e)return null;if(!S[e.type])throw y("CompilationError","Unknown expression type"+e.type);return n&&(n=n.slice()),S[e.type](e,t,n)}function T(e,n,r){if(typeof e=="string"||typeof e=="boolean"||typeof e=="number"||!e)return e;if(e.value!==t)return T(e.value,n,r);if(typeof e=="function"){var i=e(n,r);return n=i[0],i=i[1],T(i,n,r)}throw e.expression?new f("Uncalled macro: "+e.id):new f("Cannot resolve ctxdata or global of type "+typeof e)}function N(e,t){var n=e.name;return function(t,r){if(!t.__env__.hasOwnProperty(n))throw new f("Reference to an unknown entry: "+n);return t={__this__:t.__env__[n],__env__:t.__env__},[t,t.__this__]}}function C(e,t){return function(t,n){return[t,t.__this__]}}function k(e,t){var n=e.id.name;return function(t,r){if(t.hasOwnProperty(n))return t[n];if(!r||!r.hasOwnProperty(n))throw new f("Reference to an unknown variable: "+n);return[t,r[n]]}}function L(e,t){var n=e.id.name;return function(t,r){if(!o)throw new f("No globals set (tried @"+n+")");if(!o.hasOwnProperty(n))throw new f("Reference to an unknown global: "+n);try{var i=o[n].get()}catch(s){throw new f("Cannot evaluate global "+n)}return u.globals[n]=!0,[t,i]}}function A(e,t){return function(n,r){return[n,e.value]}}function O(e,t){var n,i;return function(o,u,a){if(arguments.length>2)throw new f("Cannot get property of a string: "+a);if(!i){try{n=r.parseString(e.content)}catch(c){throw new l("Malformed string. "+c.message,t,e.content)}if(n.type=="String")return[o,n.content];i=x(n,t)}try{return[o,T(i,o,u)]}catch(c){throw h(c),new l(c.message,t,e.content)}}}function M(t,n){var r=[];for(var i=0;i<t.content.length;i++)r.push(x(t.content[i],n));return function(){var t=!1;return function(i,s){if(t)throw new f("Cyclic reference detected");t=!0;var o=[];try{for(var u=0;u<r.length;u++){var a=T(r[u],i,s);if(typeof a!="string"&&typeof a!="number")throw new f("Placeables must be strings or numbers");if(a.length>e)throw new f("Placeable has too many characters, maximum allowed is "+e);o.push(a)}}finally{t=!1}return[i,o.join("")]}}()}function _(e,t){var n=x(e,t);return function(){var e=!1;return function(i,s){if(e)throw new f("Cyclic reference detected");e=!0;try{var o=T(n,i,s)}catch(u){throw u instanceof c?u:(h(u),y(c,u.message,t))}finally{e=!1}return[i,o]}}()}function D(e,n,r){var i={},s,o=r.length?r.shift():t;for(var u=0;u<e.content.length;u++){var a=e.content[u];i[a.key.name]=x(a.value,n,r),a.default&&(s=a.key.name)}return function(r,u,a){var f=[a,o,s],l=[];for(var h=0;h<f.length;h++){var p=T(f[h],r,u);if(p===t)continue;if(typeof p!="string")throw y(c,"Index must be a string",n);l.push(p);if(i.hasOwnProperty(p))return[r,i[p]]}if(l.length)var d='Hash key lookup failed (tried "'+l.join('", "')+'").';else var d="Hash key lookup failed.";throw y(c,d,n)}}function P(e,t){if(e=="-")return function(t){if(typeof t!="number")throw new f("The unary - operator takes a number");return-t};if(e=="+")return function(t){if(typeof t!="number")throw new f("The unary + operator takes a number");return+t};if(e=="!")return function(t){if(typeof t!="boolean")throw new f("The ! operator takes a boolean");return!t};throw y(a,"Unknown token: "+e,t)}function H(e,t){if(e=="==")return function(t,n){if(typeof t=="number"&&typeof n=="number"||typeof t=="string"&&typeof n=="string")return t==n;throw new f("The == operator takes two numbers or two strings")};if(e=="!=")return function(t,n){if(typeof t=="number"&&typeof n=="number"||typeof t=="string"&&typeof n=="string")return t!=n;throw new f("The != operator takes two numbers or two strings")};if(e=="<")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The < operator takes two numbers");return t<n};if(e=="<=")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The <= operator takes two numbers");return t<=n};if(e==">")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The > operator takes two numbers");return t>n};if(e==">=")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The >= operator takes two numbers");return t>=n};if(e=="+")return function(t,n){if(typeof t=="number"&&typeof n=="number"||typeof t=="string"&&typeof n=="string")return t+n;throw new f("The + operator takes two numbers or two strings")};if(e=="-")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The - operator takes two numbers");return t-n};if(e=="*")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The * operator takes two numbers");return t*n};if(e=="/")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The / operator takes two numbers");if(n==0)throw new f("Division by zero not allowed.");return t/n};if(e=="%")return function(t,n){if(typeof t!="number"||typeof n!="number")throw new f("The % operator takes two numbers");if(n==0)throw new f("Modulo zero not allowed.");return t%n};throw y(a,"Unknown token: "+e,t)}function B(e,t){if(e=="&&")return function(t,n){if(typeof t!="boolean"||typeof n!="boolean")throw new f("The && operator takes two booleans");return t&&n};if(e=="||")return function(t,n){if(typeof t!="boolean"||typeof n!="boolean")throw new f("The || operator takes two booleans");return t||n};throw y(a,"Unknown token: "+e,t)}function j(e,t){var n=P(e.operator.token,t),r=x(e.argument,t);return function(t,i){return[t,n(T(r,t,i))]}}function F(e,t){var n=x(e.left,t),r=H(e.operator.token,t),i=x(e.right,t);return function(t,s){return[t,r(T(n,t,s),T(i,t,s))]}}function I(e,t){var n=x(e.left,t),r=B(e.operator.token,t),i=x(e.right,t);return function(t,s){return[t,r(T(n,t,s),T(i,t,s))]}}function q(e,t){var n=x(e.test,t),r=x(e.consequent,t),i=x(e.alternate,t);return function(t,s){var o=T(n,t,s);if(typeof o!="boolean")throw new f("Conditional expressions must test a boolean");return o===!0?r(t,s):i(t,s)}}function R(e,t){var n=x(e.callee,t),r=[];for(var i=0;i<e.arguments.length;i++)r.push(x(e.arguments[i],t));return function(t,i){var s=[];for(var o=0;o<r.length;o++)s.push(r[o](t,i));var u=n(t,i);t=u[0],u=u[1];if(!u.expression)throw new f("Expected a macro, got a non-callable.");return u._call(s,i)}}function U(e,n){var r=x(e.expression,n),i=e.computed?x(e.property,n):e.property.name;return function(n,s){var o=T(i,n,s),u=r(n,s);n=u[0],u=u[1];if(u&&u.value!==t){if(typeof u.value!="function")throw new f("Cannot get property of a "+typeof u.value+": "+o);return u.value(n,s,o)}if(typeof u=="function")return u(n,s,o);if(u&&u.expression)throw new f("Cannot get property of a macro: "+o);if(typeof u=="object"){if(u===null)throw new f("Cannot get property of a null: "+o);if(Array.isArray(u))throw new f("Cannot get property of an array: "+o);if(!u.hasOwnProperty(o))throw new f(o+" is not defined on the object.");return[n,u[o]]}throw new f("Cannot get property of a "+typeof u+": "+o)}}function z(e,t){var n=x(e.expression,t),r=e.computed?x(e.attribute,t):e.attribute.name;return function(t,i){var s=T(r,t,i),o=n(t,i);t=o[0],o=o[1];if(!o.attributes)throw new f("Cannot get attribute of a non-entity: "+s);if(!o.attributes.hasOwnProperty(s))throw new f(o.id+" has no attribute "+s);return[t,o.attributes[s]]}}function W(e,t){return x(e.expression,t)}this.compile=d,this.setGlobals=v,this.addEventListener=m,this.removeEventListener=g;var e=2500,n=new i,r=new s(!0),o=null,u={globals:{}},p={Entity:b,Macro:E};b.prototype.getString=function(t){try{var r={__this__:this,__env__:this.env};return T(this.value,r,t)}catch(i){throw h(i),i instanceof l&&n.emit("error",i),i}},b.prototype.get=function(t){u.globals={};var n={value:this.getString(t),attributes:{}};for(var r=0,i;i=this.publicAttributes[r];r++)n.attributes[i]=this.attributes[i].getString(t);return n.globals=u.globals,n},w.prototype.getString=function(t){try{var r={__this__:this.entity,__env__:this.entity.env};return T(this.value,r,t)}catch(i){throw h(i),i instanceof l&&n.emit("error",i),i}},E.prototype._call=function(t,n){var r={__this__:this,__env__:this.env};if(this.args.length!==t.length)throw new f(this.id+"() takes exactly "+this.args.length+" argument(s) ("+t.length+" given)");for(var i=0;i<this.args.length;i++)r[this.args[i].id.name]=t[i];var s=this.expression(r,n);return r=s[0],s=s[1],[r,T(s,r,n)]};var S={Identifier:N,ThisExpression:C,VariableExpression:k,GlobalsExpression:L,Number:A,String:O,Hash:D,HashItem:x,ComplexString:M,UnaryExpression:j,BinaryExpression:F,LogicalExpression:I,ConditionalExpression:q,CallExpression:R,PropertyExpression:U,AttributeExpression:z,ParenthesisExpression:W}}function u(e){this.name="CompilerError",this.message=e}function a(e,t){u.call(this,e),this.name="CompilationError",this.entry=t.id}function f(e){u.call(this,e),this.name="RuntimeError"}function l(e,t,n){f.call(this,e),this.name="ValueError",this.entry=t.id,this.source=n}function c(e,t){f.call(this,e),this.name="IndexError",this.entry=t.id}function h(e){if(!(e instanceof u))throw e}var i=e("./events").EventEmitter,s=e("./parser").Parser;o.Error=u,o.CompilationError=a,o.RuntimeError=f,o.ValueError=l,o.IndexError=c,u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,a.prototype=Object.create(u.prototype),a.prototype.constructor=a,f.prototype=Object.create(u.prototype),f.prototype.constructor=f,l.prototype=Object.create(f.prototype),l.prototype.constructor=l,c.prototype=Object.create(f.prototype),c.prototype.constructor=c,n.Compiler=o}),n("l20n/promise",function(e,t,n){"use strict";var r=function(){this._state=0,this._value=null,this._cb={fulfilled:[],rejected:[]},this._thenPromises=[]};r.all=function(e){function i(){n--,n==0&&t.fulfill()}var t=new r,n=e.length;if(n==0)return t.fulfill(),t;for(var s in e)e[s].then(i,i);return t},r.prototype.then=function(e,t){this._cb.fulfilled.push(e),this._cb.rejected.push(t);var n=new r;return this._thenPromises.push(n),this._state>0&&setTimeout(this._processQueue.bind(this),0),n},r.prototype.fulfill=function(e){return this._state!=0?this:(this._state=1,this._value=e,this._processQueue(),this)},r.prototype.reject=function(e){return this._state!=0?this:(this._state=2,this._value=e,this._processQueue(),this)},r.prototype._processQueue=function(){while(this._thenPromises.length){var e=this._cb.fulfilled.shift(),t=this._cb.rejected.shift();this._executeCallback(this._state==1?e:t)}},r.prototype._executeCallback=function(e){var t=this._thenPromises.shift();if(typeof e!="function"){this._state==1?t.fulfill(this._value):t.reject(this._value);return}try{var n=e(this._value);if(n&&typeof n.then=="function"){var r=function(e){t.fulfill(e)},i=function(e){t.reject(e)};n.then(r,i)}else t.fulfill(n)}catch(s){t.reject(s)}},t.Promise=r}),n("l20n/retranslation",function(e,t,n){"use strict";function i(){function s(n){var r=new n;this.globals[r.id]=r;if(!r.activate)return;t[r.id]=0,r.addEventListener("change",function(t){for(var n=0;n<e.length;n++)e[n]&&e[n].globals.indexOf(t)!==-1&&e[n].callback({global:r.id})})}function o(r,i){var s,o;for(s=0;s<n.length;s++)if(n[s].id===r.id){o=!0;break}o?i&&(n[s]=r):n.push(r);var u;for(s=0;s<e.length;s++)if(e[s]&&e[s].id===r.id){u=e[s];break}if(!u)r.globals.length!=0&&(e.push(r),r.globals.forEach(function(e){if(!this.globals[e].activate)return;t[e]++,this.globals[e].activate()},this));else if(i){u.callback=r.callback;var a=r.globals.filter(function(e){return this.globals[e].activate&&u.globals.indexOf(e)===-1},this);a.forEach(function(e){t[e]++,this.globals[e].activate()},this),u.globals=u.globals.concat(a)}else if(r.globals.length==0)delete e[s];else{var a=r.globals.filter(function(e){return this.globals[e].activate&&u.globals.indexOf(e)===-1},this);a.forEach(function(e){t[e]++,this.globals[e].activate()},this);var f=u.globals.filter(function(e){return this.globals[e].activate&&r.globals.indexOf(e)===-1},this);f.forEach(function(e){t[e]--,t[e]==0&&this.globals[e].deactivate()},this),u.globals=r.globals}}function u(i){var s,o=-1;for(r=0;r<e.length;r++)if(e[r]&&e[r].id===i){s=e[r],o=r;break}if(s){s.globals.forEach(function(e){this.globals[e].activate&&(t[e]--,t[e]==0&&this.globals[e].deactivate())},this),e.splice(o,1);for(r=0;r<n.length;r++)if(n[r].id===i){n.splice(r,1);break}}}function a(e){for(var t=0;t<n.length;t++)n[t].callback({locales:e})}var e=[],t={},n=[];this.bindGet=o,this.unbindGet=u,this.all=a,this.globals={};for(var r in i._constructors)s.call(this,i._constructors[r])}var r=e("./events").EventEmitter;i._constructors=[],i.registerGlobal=function(e){i._constructors.push(e)},t.RetranslationManager=i}),n("l20n/platform/globals",function(t,n,r){"use strict";function o(){this.id=null,this._emitter=new i,this.value=null,this.isActive=!1}function u(){function n(){return{width:{px:document.body.clientWidth}}}function r(){this.isActive||(e.addEventListener("resize",s),this.isActive=!0)}function i(){e.removeEventListener("resize",s),this.value=null,this.isActive=!1}function s(){t.value=n(),t._emitter.emit("change",t.id)}o.call(this),this.id="screen",this._get=n,this.activate=r,this.deactivate=i;var t=this}function a(){function e(){return/^MacIntel/.test(navigator.platform)?"mac":/^Linux/.test(navigator.platform)?"linux":/^Win/.test(navigatgor.platform)?"win":"unknown"}o.call(this),this.id="os",this.get=e}function f(){function r(){var e=new Date;return e.getHours()}function i(){var t=new Date;t.getHours()!==e.value&&(e.value=t.getHours(),e._emitter.emit("change",e.id))}function s(){if(!this.isActive){var e=new Date;n=setTimeout(function(){i(),n=setInterval(i,t)},t-e.getTime()%t),this.isActive=!0}}function u(){clearInterval(n),this.value=null,this.isActive=!1}o.call(this),this.id="hour",this._get=r,this.activate=s,this.deactivate=u;var e=this,t=36e5,n=null}var i=t("../events").EventEmitter,s=t("../retranslation").RetranslationManager;o.prototype._get=function(){throw new Error("Not implemented")},o.prototype.get=function(){if(!this.value||!this.isActive)this.value=this._get();return this.value},o.prototype.addEventListener=function(e,t){if(e!=="change")throw"Unknown event type";this._emitter.addEventListener(e,t)},u.prototype=Object.create(o.prototype),u.prototype.constructor=u,a.prototype=Object.create(o.prototype),a.prototype.constructor=a,f.prototype=Object.create(o.prototype),f.prototype.constructor=f,s.registerGlobal(u),s.registerGlobal(a),s.registerGlobal(f),n.Global=o}),n("l20n/platform/io",function(e,t,n){"use strict";function i(e){this.name="IOError",this.message=e}var r=e("../promise").Promise;t.loadAsync=function(t){var n=new r,s=new XMLHttpRequest;return s.overrideMimeType&&s.overrideMimeType("text/plain"),s.addEventListener("load",function(){if(s.status==200||s.status==0)n.fulfill(s.responseText);else{var e=new i("Not found: "+t);n.reject(e)}}),s.addEventListener("abort",function(e){return n.reject(e)}),s.open("GET",t,!0),s.send(""),n},t.loadSync=function(t){var n=new XMLHttpRequest;n.overrideMimeType&&n.overrideMimeType("text/plain"),n.open("GET",t,!1),n.send("");if(n.status==200||n.status==0)return n.responseText;throw new i("Not found: "+t)},i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,t.Error=i}),n("l20n/intl",function(e,n,r){"use strict";function p(e){if(!l.test(e))return!1;if(e.startsWith("x-"))return!0;var t=e.indexOf("-x-");return t!==-1&&(e=e.substring(0,t)),!c.test(e)&&!h.test(e)}function d(e){e=e.toLowerCase();if(u&&u.hasOwnProperty(e))return u[e];var t=e.split("-"),n=0;while(n<t.length){var r=t[n];if(r.length===1&&(n>0||r==="x"))break;r.length===4?r=r[0].toUpperCase()+r.substring(1):n!==0&&r.length===2&&(r=r.toUpperCase()),a.hasOwnProperty(r)?r=a[r]:f.hasOwnProperty(r)&&(r=f[r].preferred,n===1&&f[r].prefix===t[0]&&(t.shift(),n--)),t[n]=r,n++}var i=t.slice(0,n).join("-"),s=[];while(n<t.length&&t[n]!=="x"){var o=n;n++;while(n<t.length&&t[n].length>1)n++;var l=sybtags.slice(o,n).join("-");s.push(l)}s.sort();var c="";n<t.length&&(c=t.slice(n).join("-"));var h=i;return s.length>0&&(h+="-"+s.join("-")),c.length>0&&(h.length>0?h+="-"+c:h=c),h}function v(e){if(e===t)return[];var n=[];typeof e=="string"&&(e=[e]);var r=e,i=r.length,s=0;while(s<i){var o=s in r;if(o){var u=r[s];typeof u!="string"&&typeof u!="object"&&ThrowError(JSMSG_INVALID_LOCALES_ELEMENT);var a=u;p(a)||ThrowError(JSMSG_INVALID_LANGUAGE_TAG,a),a=d(a),n.indexOf(a)===-1&&n.push(a)}s++}return n}function m(e,n){var r=n;for(;;){if(e.indexOf(r)!==-1)return r;var i=r.lastIndexOf("-");if(i===-1)return t;i>=2&&r[i-2]==="-"&&(i-=2),r=r.substring(0,i)}}function g(e,n){var r=n.length,i=[],s=0;while(s<r){var u=n[s],a=u.replace(o,""),f=m(e,a);f!==t&&i.push(f),s++}return i.slice(0)}function y(e,t,n){e=v(e),t=v(t);var r=g(e,t);return n?(n=d(n),r.indexOf(n)===-1&&r.push(n),r):r}String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(e,t){return t=t||0,this.indexOf(e,t)===t}});var i="-u(-[a-z0-9]{2,8})+",s=new RegExp(i),o=new RegExp(i,"g"),u={},a={},f={},l=function(){var e="[a-zA-Z]",t="[0-9]",n="(?:"+e+"|"+t+")",r="(?:art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang)",i="(?:en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)",s="(?:"+i+"|"+r+")",o="(?:x(?:-[a-z0-9]{1,8})+)",u="(?:"+t+"|[A-WY-Za-wy-z])",a="(?:"+u+"(?:-"+n+"{2,8})+)",f="(?:"+n+"{5,8}|(?:"+t+n+"{3}))",l="(?:"+e+"{2}|"+t+"{3})",c="(?:"+e+"{4})",h="(?:"+e+"{3}(?:-"+e+"{3}){0,2})",p="(?:"+e+"{2,3}(?:-"+h+")?|"+e+"{4}|"+e+"{5,8})",d=p+"(?:-"+c+")?(?:-"+l+")?(?:-"+f+")*(?:-"+a+")*(?:-"+o+")?",v="^(?:"+d+"|"+o+"|"+s+")$";return new RegExp(v,"i")}(),c=function(){var e="[a-zA-Z]",t="[0-9]",n="(?:"+e+"|"+t+")",r="(?:"+n+"{5,8}|(?:"+t+n+"{3}))",i="(?:"+n+"{2,8}-)+"+"("+r+")-"+"(?:"+n+"{2,8}-)*"+"\\1"+"(?!"+n+")";return new RegExp(i)}(),h=function(){var e="[a-zA-Z]",t="[0-9]",n="(?:"+e+"|"+t+")",r="(?:"+t+"|[A-WY-Za-wy-z])",i="-("+r+")-"+"(?:"+n+"+-)*"+"\\1"+"(?!"+n+")";return new RegExp(i)}();n.Intl={prioritizeLocales:y}}),e.L20n=u("l20n"),u("l20n/html")})(window)